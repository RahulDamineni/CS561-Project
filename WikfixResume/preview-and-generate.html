<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <link rel="icon" href="img/logo.png">
    <script>
        addEventListener("load", function () {
            setTimeout(hideURLbar, 0);
        }, false);
        
        function hideURLbar() {
            window.scrollTo(0, 1);
        }
    
    </script>
    <title>Resume Maker - Preview Data</title>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
    <link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" media="all">
    <link rel="stylesheet" href="css/style.css" type="text/css" media="all">
    <link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" media="all">
    <link href="//fonts.googleapis.com/css?family=Quattrocento+Sans:400,400i,700,700i" rel="stylesheet">
    <link href="//fonts.googleapis.com/css?family=Mukta:200,300,400,500,600,700,800" rel="stylesheet">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/mdb.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link rel="stylesheet" href="css/intlTelInput.min.css">
    <script>
        if (!localStorage.getItem('token')) {
            window.location.replace('index.html');
        }
    </script>
</head>

<body>

<section class="main">
    <div class="layer">
        <header>
            <div class="bottom-grid">
                <div class="links">
                    <!-- Navbar brand -->
                    <ul class="links-unordered-list">
                        <li class="active">
                            <a class="navbar-brand" href="index.html">Resume Maker</a>
                        </li>
                    </ul>
                </div>
                
                <div class="links">
                    <ul class="links-unordered-list">
                        <li class="active">
                            <a href="signup.html" class="">Register</a>
                        </li>
                        <li class="active">
                            <a href="about.html" class="">About Us</a>
                        </li>
                        <li class="active">
                            <a id="logout" class="nav-link" href>Logout
                                <span class="sr-only">(current)</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <main>
                <div class="container pt-5">
                    
                    <!-- grid row -->
                    <div class="row">
                        
                        <div class="col-md-8 preview-div m-auto">
                            <h2>You have entered the following details:</h2>
                            <table class="table text-white table-dark table-striped rounded">
                                <thead class="table-light text-dark">
                                <tr>
                                    <th scope="col">Field</th>
                                    <th scope="col">Your Input</th>
                                    <th scope="col"><a href="#" class="btn btn-info btn-lg" id="edit-info">
                                        <span class="glyphicon glyphicon-edit"></span> Edit
                                    </a></th>
                                </tr>
                                </thead>
                                <tbody id="preview_data">
                                </tbody>
                            </table>
                            <div class="wthree-field">
                                <button type="submit" class="btn btn-primary btn-block" id="show-template">Generate
                                    Resume
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        
        </header>
        
        <!-- JQuery -->
        <script type="text/javascript" src="js/jquery-3.4.1.min.js"></script>
        <!-- Bootstrap tooltips -->
        <script type="text/javascript" src="js/popper.min.js"></script>
        <!-- Bootstrap core JavaScript -->
        <script type="text/javascript" src="js/bootstrap.min.js"></script>
        <!-- MDB core JavaScript -->
        <script type="text/javascript" src="js/mdb.min.js"></script>
        <script src="js/modules/intlTelInput.js"></script>
        <script src="js/jquery.validate.min.js"></script>
        <script src="js/modules/events-handler.js"></script>
    </div>
    <footer>
        <div class="bottom-grid1">
            <div class="links">
                <ul class="links-unordered-list">
                    <li class="">
                        <a href="about.html" class="">About Us</a>
                    </li>
                    <li class="">
                        <a href="#" class="">Privacy Policy</a>
                    </li>
                    <li class="">
                        <a href="#" class="">Terms of Use</a>
                    </li>
                </ul>
            </div>
            <div class="copyright">
                <p>Â© 2019 Key. All rights reserved </a>
                </p>
            </div>
        </div>
    </footer>
</section>

<!-- JQuery -->
<script type="text/javascript" src="js/jquery-3.4.1.min.js"></script>

<script src="js/jquery.validate.min.js"></script>

<!-- Bootstrap tooltips -->
<script type="text/javascript" src="js/popper.min.js"></script>
<!-- Bootstrap core JavaScript -->
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<!-- MDB core JavaScript -->
<script type="text/javascript" src="js/mdb.min.js"></script>
<script src="js/modules/intlTelInput.js"></script>
<script src="js/modules/events-handler.js"></script>

<script>
    var map = {
        'name': 'Name',
        'emailID': 'Email Address',
        'contactNumber': 'Contact Number',
        'mailingAddress': 'Mailing Address',
        'careerObjective': 'Career Objective',
        'ownWebsite': 'Your Website',
        'linkedInURL': 'LinkedIn URL',
        'githubURL': 'GitHub URL',
        'googleScholarsURL': 'Google Scholars URL',
        'competitiveCodingURL': 'Competitive Coding Platform URL',
        'university': 'School Name',
        'degree': 'Degree Obtained',
        'concentration': 'Concentration of Study',
        'startDate': 'Start Date',
        'endDate': 'End Date',
        'gpa': 'GPA',
        'university1': 'Another School Name',
        'degree1': 'Degree Obtained',
        'concentration1': 'Concentration of Study',
        'startDate1': 'Start Date',
        'endDate1': 'End Date',
        'gpa1': 'GPA',
        'technical': 'Technical Skills',
        'laboratory': 'Laboratory Work',
        'languages': 'Languages Known',
        'otherSkills': 'Other Skills',
        'orgName': 'Organization Name',
        'jobTitle': 'Job title',
        'jobStartDate': 'Job Start Date',
        'jobEndDate': 'Job End Date',
        'responsibilities': 'Job Responsibilities',
        'projectTitle': 'Project Title',
        'projectStartDate': 'Project Start Date',
        'projectEndDate': 'Project End Date',
        'projectSummary': 'Project Summary',
        'accolades': 'Accolades',
        'activities': 'Activities & Interests'
    };
    
    function showPreview() {
        $.ajax({
            method: 'GET',
            //contentType: "application/json",
            //dataType: 'json',
            beforeSend: function (xhr) {
                xhr.setRequestHeader('Authorization', 'Bearer ' + localStorage.getItem('token'));
            },
            url: 'https://resume-server-561.herokuapp.com/data/fetch?user_id=' + localStorage.getItem('user_id'),
            //data: JSON.stringify(questionnaireObject),
            success: function (result) {
                if (result) {
                    var outputJSON = JSON.parse(result.data);
                    var tr;
                    for (var key of Object.keys(outputJSON)) {
                        if (outputJSON[key] && outputJSON[key] !== "--Select--") {
                            tr = $('<tr/>');
                            tr.append("<td>" + map[key] + "</td>");
                            tr.append("<td>" + outputJSON[key] + "</td>");
                            $('#preview_data').append(tr);
                        }
                    }
                }
            },
            error: function (result) {
                alert("Couldn't retrieve data!")
            }
        });
    }
    
    if (!localStorage.getItem('token')) {
        window.location.replace('index.html');
    } else {
        showPreview();
    }
</script>
</body>
</html>
